<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–µ—Ä–µ—Ç–∞—Å–∫–∏–≤–∞–Ω–∏–µ —á–∏—Å–µ–ª</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .container {
            background: white;
            border-radius: 20px;
            padding: 40px;
            max-width: 700px;
            width: 100%;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }
        
        h1 {
            color: #333;
            margin-bottom: 30px;
            text-align: center;
            font-size: 28px;
        }
        
        .question {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
        }
        
        .question-text {
            font-size: 24px;
            font-weight: bold;
            color: #f5576c;
            margin-bottom: 30px;
            text-align: center;
        }
        
        .equation {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin: 30px 0;
            flex-wrap: nowrap;
        }
        
        .number-box {
            min-width: 80px;
            height: 80px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 32px;
            font-weight: bold;
            border-radius: 15px;
            transition: all 0.3s;
            flex-shrink: 0;
        }
        
        .number-box.draggable {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            cursor: grab;
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }
        
        .number-box.draggable:hover {
            transform: scale(1.1);
            box-shadow: 0 8px 20px rgba(102, 126, 234, 0.6);
        }
        
        .number-box.draggable:active {
            cursor: grabbing;
            transform: scale(0.95);
        }
        
        .number-box.droppable {
            background: #e9ecef;
            border: 3px dashed #adb5bd;
            color: #6c757d;
            min-width: 80px;
        }
        
        .number-box.droppable.drag-over {
            background: #fff3cd;
            border-color: #ffc107;
            transform: scale(1.05);
        }
        
        .number-box.droppable.filled {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            border: 3px solid #28a745;
        }
        
        .operator {
            font-size: 36px;
            color: #333;
            font-weight: bold;
            flex-shrink: 0;
        }
        
        .equals {
            font-size: 36px;
            color: #333;
            font-weight: bold;
            flex-shrink: 0;
        }
        
        .options-container {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: nowrap;
            margin: 30px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 15px;
            overflow-x: auto;
        }
        
        #optionsList {
            display: flex;
            gap: 15px;
            flex-wrap: nowrap;
            align-items: center;
            justify-content: flex-start;
            width: 100%;
        }
        
        .options-title {
            width: 100%;
            text-align: center;
            color: #666;
            font-size: 14px;
            margin-bottom: 10px;
        }
        
        .submit-btn {
            width: 100%;
            padding: 15px;
            font-size: 20px;
            font-weight: bold;
            color: white;
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            margin-top: 20px;
        }
        
        .submit-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(245, 87, 108, 0.3);
        }
        
        .submit-btn:active {
            transform: translateY(0);
        }
        
        .submit-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .result {
            margin-top: 20px;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            font-size: 18px;
            font-weight: bold;
            display: none;
        }
        
        .result.correct {
            background: #d4edda;
            color: #155724;
            border: 2px solid #c3e6cb;
            display: block;
        }
        
        .result.incorrect {
            background: #f8d7da;
            color: #721c24;
            border: 2px solid #f5c6cb;
            display: block;
        }
        
        .explanation {
            margin-top: 15px;
            padding: 15px;
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 10px;
            color: #856404;
            display: none;
        }
        
        .explanation.show {
            display: block;
        }
        
        .status {
            text-align: center;
            color: #666;
            margin-top: 20px;
            font-size: 14px;
        }
        
        .reset-btn {
            width: 100%;
            padding: 10px;
            font-size: 16px;
            color: #666;
            background: #f8f9fa;
            border: 2px solid #dee2e6;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 10px;
        }
        
        .reset-btn:hover {
            background: #e9ecef;
        }
        
        /* Embed —Ä–µ–∂–∏–º: —Ç–æ–ª—å–∫–æ –≤–æ–ø—Ä–æ—Å, —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é —Å–∫—Ä–æ–ª–ª–∞ */
        .embed-hide { 
            display: none !important; 
        }
        
        body.embed { 
            min-height: auto !important; 
            height: auto !important;
            padding: 0 !important; 
            background: transparent !important; 
            align-items: flex-start !important; 
            justify-content: flex-start !important; 
            overflow: visible !important;
        }
        
        html.embed, html.embed body {
            overflow: visible !important;
            height: auto !important;
            max-height: none !important;
        }
        
        body.embed .container { 
            max-width: none !important; 
            width: 100% !important;
            padding: 12px 16px !important; 
            border-radius: 8px; 
            background: #fff; 
            border: 1px solid #e5e7eb;
            margin: 0 !important;
            box-shadow: 0 1px 3px rgba(0,0,0,0.08);
            overflow: visible !important;
        }
        
        body.embed .question { 
            padding: 8px 0 !important; 
            margin-bottom: 0 !important; 
            background: transparent !important; 
        }
        
        body.embed .question-text { 
            display: none !important;
        }
        
        body.embed .equation { 
            margin: 10px 0 !important; 
            gap: 8px !important;
            flex-wrap: nowrap !important;
        }
        
        body.embed .number-box { 
            min-width: 40px !important; 
            width: 40px !important;
            height: 40px !important; 
            font-size: 18px !important; 
            border-radius: 8px; 
            flex-shrink: 0;
        }
        
        body.embed .operator, 
        body.embed .equals { 
            font-size: 20px !important; 
            color: #6b7280;
            flex-shrink: 0;
        }
        
        body.embed .options-container { 
            margin: 10px 0 0 0 !important; 
            padding: 10px 12px !important; 
            background: #f9fafb; 
            border-radius: 8px; 
            gap: 8px !important;
            flex-wrap: nowrap !important;
            overflow-x: auto;
        }
        
        body.embed .options-title {
            display: none !important;
        }
        
        body.embed #optionsList {
            display: flex !important;
            flex-wrap: nowrap !important;
            gap: 8px !important;
            justify-content: flex-start;
            align-items: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 id="h1">üéØ –ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —á–∏—Å–ª–∞</h1>
        
        <div class="question">
            <div class="question-text" id="questionText">–†–µ—à–∏—Ç–µ –ø—Ä–∏–º–µ—Ä, –ø–µ—Ä–µ—Ç–∞—â–∏–≤ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —á–∏—Å–ª–∞</div>
            
            <div class="equation">
                <div class="number-box droppable" id="box1" data-position="0"></div>
                <span class="operator">+</span>
                <div class="number-box droppable" id="box2" data-position="1"></div>
                <span class="equals">=</span>
                <div class="number-box droppable filled" id="box3" data-position="2"></div>
            </div>
            
            <div class="options-container">
                <div class="options-title" id="optionsTitle">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —á–∏—Å–ª–∞ —Å—é–¥–∞:</div>
                <div id="optionsList"></div>
            </div>
            
            <button id="submitBtn" class="submit-btn">–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –æ—Ç–≤–µ—Ç</button>
            <button id="resetBtn" class="reset-btn">–°–±—Ä–æ—Å–∏—Ç—å</button>
            
            <div id="result" class="result"></div>
            <div id="explanation" class="explanation"></div>
        </div>
        
        <div class="status" id="status">–ü–µ—Ä–µ—Ç–∞—â–∏—Ç–µ —á–∏—Å–ª–∞ –≤ –ø—É—Å—Ç—ã–µ —è—á–µ–π–∫–∏</div>
    </div>

    <script>
        // –ì–ª–æ–±–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
        let currentQuestion = null;
        let taskId = 'drag-drop-task-' + Date.now();
        let filledBoxes = {};
        let draggedElement = null;
        const embedMode = /[?&]embed=1/i.test(window.location.search);

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        function init() {
            generateQuestion();
            setupEventListeners();
            setupMessageListener();
            
            // –í–∫–ª—é—á–∞–µ–º embed —Ä–µ–∂–∏–º –µ—Å–ª–∏ –Ω—É–∂–Ω–æ
            if (embedMode) {
                document.body.classList.add('embed');
                document.documentElement.classList.add('embed');
                // –°–∫—Ä—ã–≤–∞–µ–º –ª–∏—à–Ω–∏–µ —ç–ª–µ–º–µ–Ω—Ç—ã
                const elementsToHide = ['h1', 'submitBtn', 'resetBtn', 'result', 'explanation', 'status', 'questionText', 'optionsTitle'];
                elementsToHide.forEach(id => {
                    const el = document.getElementById(id);
                    if (el) el.classList.add('embed-hide');
                });
            }
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º INIT —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
            sendMessage({
                type: 'INIT',
                status: 'ready'
            });
        }

        // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –≤–æ–ø—Ä–æ—Å–∞
        function generateQuestion() {
            const a = Math.floor(Math.random() * 20) + 1;
            const b = Math.floor(Math.random() * 20) + 1;
            const answer = a + b;
            
            // –°–æ–∑–¥–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ (–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ + –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ)
            const options = [a, b];
            while (options.length < 5) {
                const random = Math.floor(Math.random() * 40) + 1;
                if (!options.includes(random)) {
                    options.push(random);
                }
            }
            // –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–µ–º
            options.sort(() => Math.random() - 0.5);
            
            currentQuestion = {
                a: a,
                b: b,
                answer: answer,
                options: options,
                question: `–†–µ—à–∏—Ç–µ: ? + ? = ${answer}`
            };
            
            filledBoxes = {};
            renderQuestion();
        }

        // –û—Ç—Ä–∏—Å–æ–≤–∫–∞ –≤–æ–ø—Ä–æ—Å–∞
        function renderQuestion() {
            // –û—á–∏—â–∞–µ–º —è—á–µ–π–∫–∏
            document.getElementById('box1').textContent = '';
            document.getElementById('box1').classList.remove('filled');
            document.getElementById('box1').classList.add('droppable');
            
            document.getElementById('box2').textContent = '';
            document.getElementById('box2').classList.remove('filled');
            document.getElementById('box2').classList.add('droppable');
            
            document.getElementById('box3').textContent = currentQuestion.answer;
            document.getElementById('box3').classList.add('filled');
            
            // –û—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ–º –≤–∞—Ä–∏–∞–Ω—Ç—ã
            const optionsList = document.getElementById('optionsList');
            optionsList.innerHTML = '';
            currentQuestion.options.forEach((num, index) => {
                const option = document.createElement('div');
                option.className = 'number-box draggable';
                option.textContent = num;
                option.draggable = true;
                option.dataset.value = num;
                option.dataset.index = index;
                option.id = `option-${index}`;
                optionsList.appendChild(option);
            });
            
            filledBoxes = {};
            updateSubmitButton();
        }

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ —Å–æ–±—ã—Ç–∏–π
        function setupEventListeners() {
            // Drag and Drop
            document.addEventListener('dragstart', handleDragStart);
            document.addEventListener('dragend', handleDragEnd);
            document.addEventListener('dragover', handleDragOver);
            document.addEventListener('drop', handleDrop);
            document.addEventListener('dragenter', handleDragEnter);
            document.addEventListener('dragleave', handleDragLeave);
            
            // –ö–Ω–æ–ø–∫–∏ (—Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –Ω–µ embed —Ä–µ–∂–∏–º)
            if (!embedMode) {
                const submitBtn = document.getElementById('submitBtn');
                const resetBtn = document.getElementById('resetBtn');
                if (submitBtn) submitBtn.addEventListener('click', handleSubmit);
                if (resetBtn) resetBtn.addEventListener('click', handleReset);
            }
        }

        // Drag and Drop –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
        function handleDragStart(e) {
            if (e.target.classList.contains('draggable')) {
                draggedElement = e.target;
                e.target.style.opacity = '0.5';
                e.dataTransfer.effectAllowed = 'move';
                e.dataTransfer.setData('text/html', e.target.innerHTML);
            }
        }

        function handleDragEnd(e) {
            if (e.target.classList.contains('draggable')) {
                e.target.style.opacity = '1';
            }
            // –£–±–∏—Ä–∞–µ–º drag-over –∫–ª–∞—Å—Å—ã
            document.querySelectorAll('.droppable').forEach(box => {
                box.classList.remove('drag-over');
            });
        }

        function handleDragOver(e) {
            if (e.target.classList.contains('droppable') && !e.target.classList.contains('filled')) {
                e.preventDefault();
                e.dataTransfer.dropEffect = 'move';
            }
        }

        function handleDragEnter(e) {
            if (e.target.classList.contains('droppable') && !e.target.classList.contains('filled')) {
                e.target.classList.add('drag-over');
            }
        }

        function handleDragLeave(e) {
            if (e.target.classList.contains('droppable')) {
                e.target.classList.remove('drag-over');
            }
        }

        function handleDrop(e) {
            e.preventDefault();
            e.stopPropagation();
            
            const targetBox = e.target;
            if (!targetBox.classList.contains('droppable') || targetBox.classList.contains('filled')) {
                return;
            }
            
            if (draggedElement && draggedElement.classList.contains('draggable')) {
                const value = parseInt(draggedElement.dataset.value);
                const position = parseInt(targetBox.dataset.position);
                
                // –ó–∞–ø–æ–ª–Ω—è–µ–º —è—á–µ–π–∫—É
                targetBox.textContent = value;
                targetBox.classList.remove('droppable');
                targetBox.classList.add('filled');
                targetBox.classList.remove('drag-over');
                
                // –°–æ—Ö—Ä–∞–Ω—è–µ–º –∑–Ω–∞—á–µ–Ω–∏–µ
                filledBoxes[position] = value;
                
                // –£–¥–∞–ª—è–µ–º —ç–ª–µ–º–µ–Ω—Ç –∏–∑ —Å–ø–∏—Å–∫–∞ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤
                draggedElement.remove();
                
                updateSubmitButton();
            }
        }

        // –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
        function updateSubmitButton() {
            if (embedMode) {
                // –í embed —Ä–µ–∂–∏–º–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç –∫–æ–≥–¥–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–æ
                const isComplete = filledBoxes[0] !== undefined && filledBoxes[1] !== undefined;
                if (isComplete) {
                    sendAnswerIfReady();
                }
                return;
            }
            
            const submitBtn = document.getElementById('submitBtn');
            const statusEl = document.getElementById('status');
            const isComplete = filledBoxes[0] !== undefined && filledBoxes[1] !== undefined;
            
            if (submitBtn) submitBtn.disabled = !isComplete;
            
            if (statusEl) {
                if (isComplete) {
                    statusEl.textContent = '–ì–æ—Ç–æ–≤–æ –∫ –ø—Ä–æ–≤–µ—Ä–∫–µ!';
                } else {
                    const missing = [];
                    if (filledBoxes[0] === undefined) missing.push('–ø–µ—Ä–≤–æ–µ');
                    if (filledBoxes[1] === undefined) missing.push('–≤—Ç–æ—Ä–æ–µ');
                    statusEl.textContent = `–ó–∞–ø–æ–ª–Ω–∏—Ç–µ ${missing.join(' –∏ ')} —á–∏—Å–ª–æ`;
                }
            }
        }
        
        // –û—Ç–ø—Ä–∞–≤–∫–∞ –æ—Ç–≤–µ—Ç–∞ –µ—Å–ª–∏ –≥–æ—Ç–æ–≤ (–¥–ª—è embed —Ä–µ–∂–∏–º–∞)
        function sendAnswerIfReady() {
            if (filledBoxes[0] === undefined || filledBoxes[1] === undefined) {
                return false;
            }
            
            const userAnswer = {
                a: filledBoxes[0],
                b: filledBoxes[1],
                answer: filledBoxes[0] + filledBoxes[1],
                question: `${filledBoxes[0]} + ${filledBoxes[1]} = ${currentQuestion.answer}`
            };
            
            sendMessage({
                type: 'SUBMIT',
                taskId: taskId,
                userAnswer: userAnswer
            });
            
            return true;
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –æ—Ç–≤–µ—Ç–∞
        function handleSubmit() {
            if (!filledBoxes[0] || !filledBoxes[1]) {
                alert('–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ —è—á–µ–π–∫–∏!');
                return;
            }
            
            const userAnswer = {
                a: filledBoxes[0],
                b: filledBoxes[1],
                answer: filledBoxes[0] + filledBoxes[1],
                question: `${filledBoxes[0]} + ${filledBoxes[1]} = ${currentQuestion.answer}`
            };
            
            // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –æ—Ç–≤–µ—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä —á–µ—Ä–µ–∑ postMessage
            sendMessage({
                type: 'SUBMIT',
                taskId: taskId,
                userAnswer: userAnswer
            });
            
            // –ë–ª–æ–∫–∏—Ä—É–µ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
            document.getElementById('submitBtn').disabled = true;
            document.getElementById('status').textContent = '–ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—Ç–≤–µ—Ç–∞...';
        }

        // –°–±—Ä–æ—Å
        function handleReset() {
            generateQuestion();
            document.getElementById('result').className = 'result';
            document.getElementById('explanation').className = 'explanation';
        }

        // –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ
        function sendMessage(data) {
            if (window.parent) {
                window.parent.postMessage(data, '*');
            }
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –æ—Ç –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
        function setupMessageListener() {
            window.addEventListener('message', (event) => {
                const data = event.data;
                
                if (data.type === 'SERVER_RESULT') {
                    handleServerResult(data);
                } else if (data.type === 'REQUEST_ANSWER') {
                    // –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –æ—Ç–≤–µ—Ç
                    if (!sendAnswerIfReady()) {
                        sendMessage({ 
                            type: 'ANSWER_NOT_READY', 
                            message: '–ó–∞–ø–æ–ª–Ω–∏—Ç–µ –æ–±–∞ –ø–æ–ª—è' 
                        });
                    }
                } else if (data.type === 'INIT') {
                    if (!embedMode) {
                        const statusEl = document.getElementById('status');
                        if (statusEl) statusEl.textContent = '–ü–æ–¥–∫–ª—é—á–µ–Ω–æ –∫ –ø–ª–∞—Ç—Ñ–æ—Ä–º–µ';
                    }
                } else if (data.type === 'RESET') {
                    handleReset();
                }
            });
        }

        // –û–±—Ä–∞–±–æ—Ç–∫–∞ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –æ—Ç —Å–µ—Ä–≤–µ—Ä–∞
        function handleServerResult(result) {
            if (embedMode) {
                // –í embed —Ä–µ–∂–∏–º–µ –ø—Ä–æ—Å—Ç–æ —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –≤–æ–ø—Ä–æ—Å –ø–æ—Å–ª–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞
                if (result.correct) {
                    setTimeout(() => {
                        handleReset();
                    }, 1000);
                } else {
                    setTimeout(() => {
                        handleReset();
                    }, 2000);
                }
                return;
            }
            
            const resultDiv = document.getElementById('result');
            const explanationDiv = document.getElementById('explanation');
            const submitBtn = document.getElementById('submitBtn');
            const statusEl = document.getElementById('status');
            
            if (result.correct) {
                if (resultDiv) {
                    resultDiv.textContent = '‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–æ! –û—Ç–ª–∏—á–Ω–æ!';
                    resultDiv.className = 'result correct';
                }
                if (statusEl) statusEl.textContent = '–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç!';
                
                // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ–º –Ω–æ–≤—ã–π –≤–æ–ø—Ä–æ—Å —á–µ—Ä–µ–∑ 2 —Å–µ–∫—É–Ω–¥—ã
                setTimeout(() => {
                    handleReset();
                }, 2000);
            } else {
                if (resultDiv) {
                    resultDiv.textContent = '‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ';
                    resultDiv.className = 'result incorrect';
                }
                if (statusEl) statusEl.textContent = '–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –µ—â–µ —Ä–∞–∑';
                
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ–±—ä—è—Å–Ω–µ–Ω–∏–µ
                if (explanationDiv) {
                    if (result.explanation) {
                        explanationDiv.textContent = result.explanation;
                    } else {
                        explanationDiv.textContent = `–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: ${currentQuestion.a} + ${currentQuestion.b} = ${currentQuestion.answer}`;
                    }
                    explanationDiv.className = 'explanation show';
                }
                
                // –†–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –ø–æ–ø—ã—Ç–∫–∏
                if (submitBtn) submitBtn.disabled = false;
            }
        }

        // –ó–∞–ø—É—Å–∫ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', init);
        } else {
            init();
        }
    </script>
</body>
</html>
